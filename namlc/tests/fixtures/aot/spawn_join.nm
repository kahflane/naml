use std::threads::*;

fn main() {
    var ch: channel<int> = open_channel(10);

    spawn {
        send(ch, 100);
    };

    spawn {
        send(ch, 200);
    };

    join();

    var sum: int = 0;
    var v1: int = receive(ch) ?? 0;
    var v2: int = receive(ch) ?? 0;
    sum = v1 + v2;

    if (sum != 300) { panic(fmt("expected 300, got {}", sum)); }

    close(ch);
    println("Done");
}
