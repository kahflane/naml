fn apply(f: fn(int) -> int, x: int) -> int {
    return f(x);
}

fn main() {
    var square: fn(int) -> int = fn (x: int) -> int { return x * x; };
    var result: int = square(5);
    if (result != 25) { panic("square"); }

    var doubled: int = apply(fn (n: int) -> int { return n * 2; }, 7);
    if (doubled != 14) { panic("apply"); }

    var add: fn(int, int) -> int = fn (a: int, b: int) -> int { return a + b; };
    if (add(3, 4) != 7) { panic("add lambda"); }

    var nums: [int] = [1, 2, 3, 4, 5];
    var total: int = 0;
    for (n: int in nums) {
        total = total + apply(fn (x: int) -> int { return x * 10; }, n);
    }
    if (total != 150) { panic("fold"); }

    println("OK");
}
